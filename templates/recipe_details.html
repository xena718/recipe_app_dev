{% extends 'base.html' %}

{% block title %}{{ recipe.title }} - Details{% endblock %}

{% block body %}

<div class="recipe-title-author-description">
  <h2>{{ recipe.title }}</h2>
  <p>by {{recipe.author}}</p>
  
  <h4>Description</h4>
  <div>
    {{ recipe.description }}
  </div>
</div>

<div class="recipe-summary-img-save-btn">
  <div class="recipe-img-save-btn-text-under-img">
    <img src="{{ recipe.photo_url }}">
    {% if (session.get("logged_in_user_email")) and (recipe in current_user.saved_recipes) %}
    <div class="card-btn-div">
      <button class="save-remove-btn" data-recipe-id="{{ recipe.recipe_id }}" method="POST"><i id="save-remove-icon" class="bi bi-heart-fill"></i></button>
    </div>
    {% else %}
    <div class="card-btn-div">
      <button class="save-remove-btn" data-recipe-id="{{ recipe.recipe_id }}" method="POST"><i id="save-remove-icon" class="bi bi-heart"></i></button>
    </div>
    {% endif %}
  
    <div>
      {{ recipe.cuisine.name }}
      {% for specialdiet in recipe.specialdiets %}
      | {{specialdiet.name}}
      {% endfor %}
    </div>
  </div>

  <div class="recipe-summary-card">
    <div> Prep: {{recipe.prep_time}}</div>
    <div> Cook: {{recipe.cook_time}}</div>
    {% set prep_time_list = recipe.prep_time.split(' ')  %}
    {% set cook_time_list = recipe.cook_time.split(' ')  %}

    {% if (prep_time_list[1] =="days") and (cook_time_list[1]=="days") %}
      <div> Total: {{prep_time_list[0] | int +cook_time_list[0] | int}} days</div>
    {% elif prep_time_list[1] =="days" %}  
      <div> Total: {{recipe.prep_time}} {{recipe.cook_time}} </div>
    {% elif cook_time_list[1] =="days" %}  
      <div> Total: {{recipe.cook_time}} {{recipe.prep_time}} </div>
    {% elif prep_time_list[1] != cook_time_list[1] %}
      {% if prep_time_list[1] == "hours" %}
      <div> Total: {{recipe.prep_time}} {{recipe.cook_time}}  </div>
      {% elif cook_time_list[1] == "hours" %}
      <div> Total: {{recipe.cook_time}} {{recipe.prep_time}} </div>
      {% endif %}

    {% else %}
    <div> Total: {{prep_time_list[0] | int +cook_time_list[0] | int}}  {{prep_time_list[1]}} </div>
    {% endif %}
    <div> Servings: {{recipe.servings}}</div>
  </div>
</div>

<div class="row">
  <div class="col-sm-3 ingredients-title-div">
    <h4>Ingredients</h4>
  </div>
  <div class="col-sm-9 servings-size-adjust-div">
    <form action="/servings-size-form">
      <label for="servings-size-adjust"></label>
      <input type="number" id="servings-size-adjust" name="servings-size-adjust" value="{{recipe.servings}}" style="width: 70px;">
      <input type="submit" class = "adjust-btn" value="Adjust">
    </form>
    <p>Original recipe yields {{recipe.servings}} servings</p>
  </div>
</div>


<!-- <div class="row recipe-ingredients-div">
  {% for ingredient in recipe.recipe_ingredients %}
  <form action="/recipe-ingredient-checkbox">
    <input type="checkbox" id="recipe-ingredient" name="recipe-ingredient" value="{{ingredient}}">
    <label for="recipe-ingredient"> {{ingredient.quantity}} {{ingredient.unit.name}} {{ingredient.name}}</label><br>
  </form>
  {% endfor %}
</div> -->

<div class="form-check recipe-ingredients-div">
  {% for ingredient in recipe.recipe_ingredients %}
  <form action="/recipe-ingredient-checkbox">
    <input class="form-check-input" type="checkbox" id="flexCheckDefault recipe-ingredient" name="recipe-ingredient" value="{{ingredient}}">
    <label class="form-check-label" for="flexCheckDefault recipe-ingredient"> {{ingredient.quantity}} {{ingredient.unit.name}} {{ingredient.name}}</label><br>
  </form>
  {% endfor %}
</div>


<div>
  <form action="/add-to-shoppinglist/{{ recipe.recipe_id }}" method="POST">
    <input type="submit" value="Add all ingredients to shopping List">
  </form>
</div>


<h4>Directions</h4>
<div>
  {% for direction in recipe.recipe_directions %}
    <div> Step {{direction.step_number}}: {{direction.step_guidance}}</div>
  {% endfor %}
</div>

{% endblock %}
